sap.ui.define(["./BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/model/Sorter","sap/ui/core/UIComponent","sap/ui/core/routing/History","sap/m/PDFViewer"],function(e,t,o,i,r,s,a,l,n){"use strict";return e.extend("com.myorg.myUI5App.controller.SearchProducts",{onInit:function(){var e={RicercaAvanzata:false,SelectedItems:"",SelectedCodice:"",SelectedDescrizione:"",columnVisible:false,selectedCheck:false,SelectedCategoria:"",visibleArticolo:false,CategoriesInfo:[{Name:"",id:""},{Name:"ANTINCENDIO",id:"AI"},{Name:"ANTIRUMORE",id:"AR"},{Name:"ATTR. ELETTRICHE",id:"AE"}],selectedSerie:"",SerieInfo:[{Name:"",id:""},{Name:"ACCESSORI VARI",id:"AV"},{Name:"ANTIRUMORE CUFFIE",id:"AC"},{Name:"BANDE",id:"BN"}]};var t=new i(e);this.getView().setModel(t,"dropDownModel");this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute("SearchProducts").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(){debugger;var e=this.getView().getModel("dropDownModel");var t=e.getProperty("/columnVisible");if(t){e.setProperty("/columnVisible",false)}e.setProperty("/SelectedDescrizione","");e.setProperty("/SelectedCategoria","");e.setProperty("/selectedSerie","");e.setProperty("/selectedCodice","");e.setProperty("/selectedCheck",false);e.setProperty("/SelectedItems","");e.setProperty("/visibleArticolo",false)},onFilterTable:function(){this.getView().byId("idProductsTableItems").removeSelections();var e=[];var i=this.getView().getModel("dropDownModel");var r=i.getProperty("/SelectedCodice");var s=i.getProperty("/SelectedDescrizione");var a=i.getProperty("/SelectedCategoria");var l=i.getProperty("/selectedSerie");var n=i.getProperty("/columnVisible");var d=i.getProperty("/SelectedItems");if(!n){i.setProperty("/columnVisible",true)}if(r){e.push(new t("codice",o.Contains,r))}if(s){e.push(new t("description",o.Contains,s))}if(a){e.push(new t("categoria",o.Contains,a))}if(l){e.push(new t("serie",o.Contains,l))}if(d){const i=new t({filters:[new t("codice",o.Contains,d),new t("description",o.Contains,d),new t("codicePrecedente",o.Contains,d)],and:false});e.push(i)}var c=this.getView().byId("idProductsTableItems");var p=c.getBinding("items");p.filter(e)},onSelectCheckBox:function(e){var t=e.getSource().getSelected();var o=this.getView().getModel("dropDownModel");if(t===true){o.setProperty("/visibleArticolo",true)}else{o.setProperty("/visibleArticolo",false)}},onOpenDetailProduct:function(e,t){debugger;var o=this.getModel("Clothing");var t=e.getSource().getParent().getParent().getBindingContext("Clothing").getObject();var i=t.description;var r=t.serieText;var s=t.categoriaText;var l=t.taglie;var n=t.colori;var d=t.codice;var c=t.prezzoFisso;var p=t.taglieText;var g=t.taglieText1;var u=t.prezzo;var P=t.calcolo;var h=t.calcolo3;var v=t.sconto;var y=t.totale;var f=t.prezzoFisso3;var b=t.prezzo3;o.setProperty("/detail/textDescrizione",i);o.setProperty("/detail/textSerie",r);o.setProperty("/detail/categoriaText",s);o.setProperty("/detail/titleProd","Scheda Articolo"+" "+i);o.setProperty("/detail/titleCodice","Calcola il prezzo per il prodotto"+" "+d);o.setProperty("/detail/titleDesc","Dati Aggiuntivi Articolo"+" "+d);o.setProperty("/detail/textTaglie",l);o.setProperty("/detail/textColore",n);o.setProperty("/detail/prezzoListino1",c+"€");o.setProperty("/detail/prezzoListino3",f+"€");o.setProperty("/detail/taglieObj",p);o.setProperty("/detail/taglieObj1",g);o.setProperty("/detail/prezzo",u);o.setProperty("/detail/calcolo",P);o.setProperty("/detail/calcolo3",h);o.setProperty("/detail/sconto",v);o.setProperty("/detail/prezzoFissoModel",c);o.setProperty("/detail/prezzoFissoModel3",f);o.setProperty("/detail/totale",y);o.setProperty("/detail/prezzo3",b);var m=a.getRouterFor(this);m.navTo("DetailProduct",{},true);this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute("DetailProduct").attachPatternMatched(this._onObjectMatched,this)},onBackProduct:function(e){var t=l.getInstance();var o=t.getPreviousHash();if(o!==undefined){window.history.go(-1)}else{var i=a.getRouterFor(this);i.navTo("Home",{},true)}},_getDialogProductAvailable:function(){if(!this._oDialogProdAvailab){r.load({name:"com.myorg.myUI5App.view.fragment.ProductAvailability",controller:this}).then(function(e){e.setModel(this.getOwnerComponent().getModel("Clothing"),"Clothing");e.setModel(this.getView().getModel("dropDownModel"),"dropDown");this._oDialogProdAvailab=e;e.open()}.bind(this))}else{this._oDialogProdAvailab.open()}},onOpenDialogProductAvailability:function(e){var t=e.getSource().getParent().getParent().getBindingContext("Clothing").getObject();var o=t.description;this.getModel("dropDownModel").setProperty("/textDisponibilita","Disponibilità prodotto "+o);this._getDialogProductAvailable()},onCloseProd:function(){this._oDialogProdAvailab.close()},onReset:function(){this.bDescending=false;var e=this.byId("idProductsTableItems").getSelectedItems();for(let t=0;t<e.length;t++){e[t].setSelected(false)}this.fnApplyFiltersAndOrdering();var t=this.getModel("dropDownModel");t.setProperty("/SelectedCodice","");t.setProperty("/SelectedDescrizione","");t.setProperty("/SelectedCategoria","");t.setProperty("/selectedSerie","");t.setProperty("/SelectedItems","")},onSort:function(){this.bDescending=!this.bDescending;this.fnApplyFiltersAndOrdering()},fnApplyFiltersAndOrdering:function(){var e=[],t=[];if(this.bGrouped){t.push(new s("codice",this.bDescending,this._fnGroup))}else{t.push(new s("codice",this.bDescending))}this.byId("idProductsTableItems").getBinding("items").filter(e).sort(t)}})});