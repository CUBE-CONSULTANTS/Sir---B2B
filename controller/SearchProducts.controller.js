sap.ui.define(["./BaseController","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/model/Sorter","sap/ui/core/UIComponent","sap/ui/core/routing/History","sap/m/PDFViewer"],function(e,t,i,o,r,s,l,n,a,d){"use strict";return e.extend("com.myorg.myUI5App.controller.SearchProducts",{onInit:function(){var e={RicercaAvanzata:false,visibleCodice:false,textDisponibilita:"",visibleDescrizione:false,visibleCategoria:false,visibleSerie:false,SelectedItems:"",SelectedCodice:"",SelectedDescrizione:"",columnVisible:false,selectedCategory:"",selectedCheck:false,enabledCart:false,SelectedCategoria:"AI",Categories:[{Name:"ANTINCENDIO",id:"AI"},{Name:"ANTIRUMORE",id:"AR"},{Name:"ATTR. ELETTRICHE",id:"AE"}]};var t=new r(e);this.getView().setModel(t,"dropDownModel");this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute("SearchProducts").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(){debugger;var e=this.getView().getModel("dropDownModel");var t=e.getProperty("/columnVisible");if(t){e.setProperty("/columnVisible",false)}e.setProperty("/selectedCheck",false);e.setProperty("/visibleCodice",false);e.setProperty("/visibleDescrizione",false);e.setProperty("/visibleCategoria",false);e.setProperty("/visibleSerie",false);e.setProperty("/selectedCategory","");e.setProperty("/SelectedCodice","");e.setProperty("/SelectedDescrizione","")},onFilterTable:function(){debugger;this.getView().byId("idProductsTableItems").removeSelections();var e=[];var t=this.getView().getModel("dropDownModel");var r=t.getProperty("/SelectedCodice");var s=t.getProperty("/SelectedDescrizione");var l=t.getProperty("/selectedCategory");var n=t.getProperty("/SelectedItems");var a=t.getProperty("/columnVisible");if(!a){t.setProperty("/columnVisible",true)}if(r){e.push(new i("codice",o.Contains,r))}if(s){e.push(new i("description",o.Contains,s))}if(l){e.push(new i("categoria",o.Contains,l))}if(n){e.push(new i("",o.Contains,n))}var d=this.getView().byId("idProductsTableItems");var g=d.getBinding("items");g.filter(e)},onSelectCheckBox:function(e){debugger;var t=e.getSource().getSelected();var i=this.getView().getModel("dropDownModel");if(t===true){i.setProperty("/visibleCodice",true);i.setProperty("/visibleDescrizione",true);i.setProperty("/visibleCategoria",true);i.setProperty("/visibleSerie",true)}else{i.setProperty("/visibleCodice",false);i.setProperty("/visibleDescrizione",false);i.setProperty("/visibleCategoria",false);i.setProperty("/visibleSerie",false)}},onSelectItems:function(){debugger;var e=this.byId("idProductsTableItems").getSelectedItems();var t=this.getModel("dropDownModel").getProperty("/columnVisible");if(e.length>0&&t==true){this.getModel("dropDownModel").setProperty("/enabledCart",true)}else{this.getModel("dropDownModel").setProperty("/enabledCart",false)}},_getDialogFile:function(){debugger;if(!this._oDialogFile){s.load({name:"com.myorg.myUI5App.view.fragment.FileDocument",controller:this}).then(function(e){e.setModel(this.getOwnerComponent().getModel("Clothing"),"Clothing");e.setModel(this.getView().getModel("dropDownModel"),"dropDownModel");e.setModel(this.getView().getModel("pdfModel"));this._oDialogFile=e;e.open()}.bind(this))}else{this._oDialogFile.open()}},openFileDocument:function(e){this._getDialogFile()},onCloseFilterOptionsDialogCancel:function(e){debugger;this._oDialogFilter;e.getSource().getParent().close()},_getDialogProductAvailable:function(){if(!this._oDialogProdAvailab){s.load({name:"com.myorg.myUI5App.view.fragment.ProductAvailability",controller:this}).then(function(e){e.setModel(this.getOwnerComponent().getModel("Clothing"),"Clothing");e.setModel(this.getView().getModel("dropDownModel"),"dropDown");this._oDialogProdAvailab=e;e.open()}.bind(this))}else{this._oDialogProdAvailab.open()}},onOpenDialogProductAvailability:function(e){var t=e.getSource().getParent().getParent().getBindingContext("Clothing").getObject();var i=t.description;this.getModel("dropDownModel").setProperty("/textDisponibilita","Disponibilit√† prodotto "+i);this._getDialogProductAvailable();debugger},onCloseProd:function(e){debugger;this._oDialogProdAvailab.close()},onReset:function(e){debugger;this.bDescending=false;this.fnApplyFiltersAndOrdering();var t=this.getModel("dropDownModel");t.setProperty("/SelectedCodice","");t.setProperty("/SelectedDescrizione","");t.setProperty("/selectedCategory","");t.setProperty("/selectedSerie","")},onSort:function(e){this.bDescending=!this.bDescending;this.fnApplyFiltersAndOrdering()},fnApplyFiltersAndOrdering:function(e){debugger;var t=[],i=[];if(this.bGrouped){i.push(new l("codice",this.bDescending,this._fnGroup))}else{i.push(new l("codice",this.bDescending))}this.byId("idProductsTableItems").getBinding("items").filter(t).sort(i)},navBackHome:function(){var e=a.getInstance();var t=e.getPreviousHash();if(t!==undefined){window.history.go(-1)}else{var i=n.getRouterFor(this);i.navTo("Home",{},true)}},onCloseFilterOptionsDialogCancel:function(e){debugger;this._oDialogFilter;e.getSource().getParent().close()},handleLinkPress:function(e){debugger;var t=new d;this.getView().addDependent(t);var i=e.getSource().getModel().getData().Source;var o=i+"GetPdfSet(Serial='C0003',Filename='')/$value";t.setTitle("File preview");t.setSource(o);t.open()}})});