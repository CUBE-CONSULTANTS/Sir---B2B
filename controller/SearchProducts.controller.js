sap.ui.define(["./BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/model/Sorter","sap/ui/core/UIComponent","sap/ui/core/routing/History","sap/m/PDFViewer"],function(e,t,o,i,r,s,l,a,n){"use strict";return e.extend("com.myorg.myUI5App.controller.SearchProducts",{onInit:function(){var e={RicercaAvanzata:false,SelectedItems:"",SelectedCodice:"",SelectedDescrizione:"",columnVisible:false,selectedCheck:false,SelectedCategoria:"",visibleArticolo:false,CategoriesInfo:[{Name:"",id:""},{Name:"ANTINCENDIO",id:"AI"},{Name:"ANTIRUMORE",id:"AR"},{Name:"ATTR. ELETTRICHE",id:"AE"}],selectedSerie:"",SerieInfo:[{Name:"",id:""},{Name:"ACCESSORI VARI",id:"AV"},{Name:"ANTIRUMORE CUFFIE",id:"AC"},{Name:"BANDE",id:"BN"}]};var t=new i(e);this.getView().setModel(t,"dropDownModel");this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute("SearchProducts").attachPatternMatched(this._onObjectMatched,this)},_onObjectMatched:function(){debugger;var e=this.getView().getModel("dropDownModel");var t=e.getProperty("/columnVisible");if(t){e.setProperty("/columnVisible",false)}e.setProperty("/SelectedDescrizione","");e.setProperty("/SelectedCategoria","");e.setProperty("/selectedSerie","");e.setProperty("/selectedCodice","");e.setProperty("/selectedCheck",false);e.setProperty("/SelectedItems","");e.setProperty("/visibleArticolo",false)},onFilterTable:function(){this.getView().byId("idProductsTableItems").removeSelections();var e=[];var i=this.getView().getModel("dropDownModel");var r=i.getProperty("/SelectedCodice");var s=i.getProperty("/SelectedDescrizione");var l=i.getProperty("/SelectedCategoria");var a=i.getProperty("/selectedSerie");var n=i.getProperty("/columnVisible");if(!n){i.setProperty("/columnVisible",true)}if(r){e.push(new t("codice",o.Contains,r))}if(s){e.push(new t("description",o.Contains,s))}if(l){e.push(new t("categoria",o.Contains,l))}if(a){e.push(new t("serie",o.Contains,a))}var d=this.getView().byId("idProductsTableItems");var c=d.getBinding("items");c.filter(e)},onSelectCheckBox:function(e){var t=e.getSource().getSelected();var o=this.getView().getModel("dropDownModel");if(t===true){o.setProperty("/visibleArticolo",true)}else{o.setProperty("/visibleArticolo",false)}},onOpenDetailProduct:function(e){debugger;var t=this.getModel("Clothing");var o=e.getSource().getParent().getParent().getBindingContext("Clothing").getObject();var i=o.description;var r=o.serieText;var s=o.categoriaText;var a=o.taglie;var n=o.colori;var d=o.codice;var c=o.prezzoFisso;var p=o.taglieText;var g=o.taglieText1;var u=o.prezzo;var P=o.calcolo;var h=o.calcolo3;var v=o.sconto;var y=o.totale;var f=o.prezzoFisso3;var b=o.prezzo3;t.setProperty("/detail/textDescrizione",i);t.setProperty("/detail/textSerie",r);t.setProperty("/detail/categoriaText",s);t.setProperty("/detail/titleProd","Scheda Articolo"+" "+i);t.setProperty("/detail/titleCodice","Calcola il prezzo per il prodotto"+" "+d);t.setProperty("/detail/titleDesc","Dati Aggiuntivi Articolo"+" "+d);t.setProperty("/detail/textTaglie",a);t.setProperty("/detail/textColore",n);t.setProperty("/detail/prezzoListino1",c+"€");t.setProperty("/detail/prezzoListino3",f+"€");t.setProperty("/detail/taglieObj",p);t.setProperty("/detail/taglieObj1",g);t.setProperty("/detail/prezzo",u);t.setProperty("/detail/calcolo",P);t.setProperty("/detail/calcolo3",h);t.setProperty("/detail/sconto",v);t.setProperty("/detail/prezzoFissoModel",c);t.setProperty("/detail/prezzoFissoModel3",f);t.setProperty("/detail/totale",y);t.setProperty("/detail/prezzo3",b);var m=l.getRouterFor(this);m.navTo("DetailProduct",{},true)},onBackProduct:function(e){var t=a.getInstance();var o=t.getPreviousHash();if(o!==undefined){window.history.go(-1)}else{var i=l.getRouterFor(this);i.navTo("Home",{},true)}},_getDialogProductAvailable:function(){if(!this._oDialogProdAvailab){r.load({name:"com.myorg.myUI5App.view.fragment.ProductAvailability",controller:this}).then(function(e){e.attachAfterOpen(this.onDialogAfterOpen,this);e.setModel(this.getOwnerComponent().getModel("Clothing"),"Clothing");e.setModel(this.getView().getModel("dropDownModel"),"dropDown");this._oDialogProdAvailab=e;e.open()}.bind(this))}else{this._oDialogProdAvailab.open()}},onDialogAfterOpen:function(){debugger},onOpenDialogProductAvailability:function(e){var t=e.getSource().getParent().getParent().getBindingContext("Clothing").getObject();var o=t.description;this.getModel("dropDownModel").setProperty("/textDisponibilita","Disponibilità prodotto "+o);this._getDialogProductAvailable()},onCloseProd:function(){this._oDialogProdAvailab.close()},onReset:function(){debugger;this.bDescending=false;var e=this.byId("idProductsTableItems").getSelectedItems();for(let t=0;t<e.length;t++){e[t].setSelected(false)}this.fnApplyFiltersAndOrdering();var t=this.getModel("dropDownModel");t.setProperty("/SelectedCodice","");t.setProperty("/SelectedDescrizione","");t.setProperty("/SelectedCategoria","");t.setProperty("/selectedSerie","");t.setProperty("/SelectedItems","")},onSort:function(){this.bDescending=!this.bDescending;this.fnApplyFiltersAndOrdering()},fnApplyFiltersAndOrdering:function(){var e=[],t=[];if(this.bGrouped){t.push(new s("codice",this.bDescending,this._fnGroup))}else{t.push(new s("codice",this.bDescending))}this.byId("idProductsTableItems").getBinding("items").filter(e).sort(t)}})});